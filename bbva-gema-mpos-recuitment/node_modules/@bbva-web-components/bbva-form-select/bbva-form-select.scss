@import "node_modules/@cells-components/cells-sass/main";

$breakpoint: 600px;

:host {
  --_select-bg-color: var(--bbva-form-select-bg-color, #{fallbackVar("foundations.colors.secondary100")});
  --_select-border-color: var(--bbva-form-select-border-color, #{fallbackVar("foundations.colors.secondary500")});
  --_select-readonly-border-color: var(--bbva-form-select-readonly-border-color, #{fallbackVar("foundations.colors.secondary500")});

  --_select-button-color: var(--bbva-form-select-button-color, #{fallbackVar("foundations.colors.secondary600")});
  --_select-readonly-button-color: var(--bbva-form-select-readonly-button-color, #{fallbackVar("foundations.colors.secondary500")});

  --_select-label-color: var(--bbva-form-select-label-color, #{fallbackVar("foundations.colors.secondary500")});
  --_select-filled-label-color: var(--bbva-form-select-filled-label-color, #{fallbackVar("foundations.colors.secondary500")});
  --_select-readonly-label-color: var(--bbva-form-select-readonly-label-color, #{fallbackVar("foundations.colors.secondary500")});

  --_select-icon-color: var(--bbva-form-select-icon-color, #{fallbackVar("foundations.colors.primaryMedium")});
  --_select-readonly-icon-color: var(--bbva-form-select-readonly-icon-color, #{fallbackVar("foundations.colors.secondary500")});

  --_message-color: var(--bbva-form-select-message-color, #{fallbackVar("foundations.colors.secondary600")});
  --_message-icon-color: var(--bbva-form-select-message-icon-color, #{fallbackVar("foundations.colors.tertiaryType1Dark")});
  --_info-message-color: var(--bbva-form-select-info-message-color, #{fallbackVar("foundations.colors.secondary500")});
  --_info-message-icon-color: var(--bbva-form-select-info-message-icon-color, #{fallbackVar("foundations.colors.primarySubdued")});

  --_invalid-select-bg-color: var(--bbva-form-select-invalid-bg-color, #{fallbackVar("foundations.colors.tertiaryType5Lightened")});
  --_invalid-select-border-color: var(--bbva-form-select-invalid-border-color, #{fallbackVar("foundations.colors.tertiaryType5Medium")});
  --_invalid-select-label-color: var(--bbva-form-select-invalid-label-color, #{fallbackVar("foundations.colors.tertiaryType1Dark")});
  --_invalid-select-icon-color: var(--bbva-form-select-invalid-icon-color, #{fallbackVar("foundations.colors.tertiaryType1Dark")});

  display: block;
  box-sizing: border-box;
  position: relative;
  @apply --bbva-form-select;
}

:host([hidden]), [hidden] {
  display: none !important;
}

*, *::before, *::after {
  box-sizing: inherit;}

.sr-only {
  @include visuallyhidden;
}

.slot-select ::slotted(select) {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  opacity: 0;
  z-index: -1;
  pointer-events: none;
  @apply --bbva-form-select-select;
}

.button {
  position: relative;
  width: 100%;
  height: rem(48px);
  font-family: inherit;
  font-size: fallbackVar("foundations.typography.typeSmall");
  line-height: fallbackVar("foundations.lineHeight.typeSmall");
  font-weight: fallbackVar("foundations.fontFacePrimary.book.fontWeight");
  background-color: var(--_select-bg-color);
  color: var(--_select-button-color);
  border: none;
  border-bottom: 1px solid var(--_select-border-color);
  border-radius: 1px;
  margin: 0;
  outline: none;
  padding: 0;
  cursor: pointer;
  text-align: left;
  @apply --bbva-form-select-button;

  &::-moz-focus-inner {
    border: 0;
  }

  &[aria-invalid=true] {
    background-color: var(--_invalid-select-bg-color);
    border-bottom-color: var(--_invalid-select-border-color);
    @apply --bbva-form-select-invalid-button;
  }

  &[disabled] {
    opacity: .4;
    cursor: default;
    @apply --bbva-form-select-disabled-button;
  }

  :host([readonly]) & {
    color: var(--_select-readonly-button-color);
    border-bottom-color: var(--_select-readonly-border-color);
    cursor: default;
    @apply --bbva-form-select-readonly-button;
  }

  &-content {
    display: flex;
    align-items: center;
    height: 100%;
    @apply --bbva-form-select-button-content;
  }

  &-clip {
    flex: none;
    max-width: rem(48px);
    margin-left: grid8Spacer(16px);
    display: flex;
    align-items: center;
    @apply --bbva-form-select-button-clip;
  }

  &-text {
    flex: auto;
    position: relative;
    height: 100%;
    padding: grid8Spacer(20px, em, 15px) 0 grid8Spacer(4px, em, 15px);
    margin-left: grid8Spacer(16px);
    min-width: 0;
    @apply --bbva-form-select-button-text;
  }

  &-icon {
    flex: none;
    margin-right: grid8Spacer(4px);
    width: rem(48px);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--_select-icon-color);
    @apply --bbva-form-select-button-icon;

    [aria-invalid=true] & {
      color: var(--_invalid-select-icon-color);
      @apply --bbva-form-select-invalid-button-icon;
    }

    :host([readonly]) & {
      color: var(--_select-readonly-icon-color);
      @apply --bbva-form-select-readonly-button-icon;
    }
  }
}

.label {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  color: var(--_select-label-color);
  will-change: transform;
  transform: translateY(grid8Spacer(12px));
  transform-origin: top left;
  transition: transform .2s ease-in-out;
  @include ellipsis;
  @apply --bbva-form-select-label;

  [aria-invalid=true] & {
    color: var(--_invalid-select-label-color);
    @apply --bbva-form-select-invalid-label;
  }

  :host([filled]) & {
    width: 125%;
    color: var(--_select-filled-label-color);
    transform: translateY(grid8Spacer(2.4px)) scale(0.8);
    transition: transform .2s ease-in-out;
    @apply --bbva-form-select-filled-label;
  }

  :host([readonly]) & {
    color: var(--_select-readonly-label-color);
    @apply --bbva-form-select-readonly-label;
  }
}

.content {
  display: flex;
  @apply --bbva-form-select-content;

  &-text {
    flex: auto;
    min-width: 0;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    @apply --bbva-form-select-content-text;
  }

  &-value {
    flex: none;
    margin-left: grid8Spacer(8px);
    @apply --bbva-form-select-content-value;
  }
}

.options {
  &-layer {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    opacity: 0;
    visibility: hidden;
    transition: opacity .2s, visibility 0s .2s;
    @apply --bbva-form-select-options-layer;

    &.opened {
      opacity: 1;
      visibility: visible;
      transition: opacity .2s, visibility 0s 0s;
      @apply --bbva-form-select-opened-options-layer;
    }
  }

  &-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.95;
    background-color: fallbackVar("foundations.colors.primaryCoreDarkened");
    @apply --bbva-form-select-options-overlay;
  }

  &-gradient {
    position: relative;
    max-width: rem(288px);
    width: 100%;
    @apply --bbva-form-select-options-gradient;

    &::before,
    &::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      height: rem(40px);
      @apply --bbva-form-select-options-gradient-element;
    }

    &::before {
      top: 0;
      background: linear-gradient(to bottom, fallbackVar("foundations.colors.primaryCoreLightened"), rgba(255, 255, 255, 0));
      @apply --bbva-form-select-options-gradient-top-element;
    }

    &::after {
      bottom: 0;
      background: linear-gradient(to top, fallbackVar("foundations.colors.primaryCoreLightened"), rgba(255, 255, 255, 0));
      @apply --bbva-form-select-options-gradient-bottom-element;
    }
  }

  &-wrapper {
    overflow-y: auto;
    min-height: rem(224px);
    max-height: rem(464px);
    padding: rem(40px) 0;
    background-color: fallbackVar("foundations.colors.primaryCoreLightened");
    box-shadow: 0 1px 1px 0 rgba(18, 18, 18, .2);
    border-radius: 1px;
    @apply --bbva-form-select-options-wrapper;
  }
}

.message {
  padding: grid8Spacer(8px) grid8Spacer(16px) 0;
  display: flex;
  align-items: center;
  font-size: fallbackVar('foundations.typography.type3XSmall');
  line-height: fallbackVar('foundations.lineHeight.type3XSmall');
  color: var(--_message-color);
  @apply --bbva-form-select-message;

  &.info {
    color: var(--_info-message-color);
    @apply --bbva-form-select-info-message;
  }

  &-icon {
    margin-right: grid8Spacer(8px);
    color: var(--_message-icon-color);
    @apply --bbva-form-select-message-icon;

    .info & {
      color: var(--_info-message-icon-color);
      @apply --bbva-form-select-info-message-icon;
    }
  }
}

@media (min-width: $breakpoint) {
  .options {
    &-layer {
      position: absolute;
      top: rem(48px);
      bottom: auto;
      display: block;
      padding: 0;
      transition: none;
      @apply --bbva-form-select-dt-options-layer;

      &.opened {
        transition: none;
        @apply --bbva-form-select-dt-opened-options-layer;
      }
    }

    &-overlay {
      display: none;
      @apply --bbva-form-select-dt-options-overlay;
    }

    &-gradient {
      max-width: none;
      @apply --bbva-form-select-dt-options-gradient;

      &::before,
      &::after {
        display: none;
        @apply --bbva-form-select-dt-options-gradient-element;
      }
    }

    &-wrapper {
      padding: 0;
      max-height: none;
      min-height: rem(144px);
      box-shadow: fallbackVar("foundations.boxShadow.type1");
      @apply --bbva-form-select-dt-options-wrapper;
    }
  }
}
