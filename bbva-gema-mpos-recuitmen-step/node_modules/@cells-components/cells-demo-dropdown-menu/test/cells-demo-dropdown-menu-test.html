<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>cells-demo-dropdown-menu test</title>
  <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  <script src="../node_modules/mocha/mocha.js"></script>
  <script src="../node_modules/wct-mocha/wct-mocha.js"></script>
  <script src="../node_modules/chai/chai.js"></script>
  <script src="../node_modules/sinon/pkg/sinon.js"></script>
  <script src="../node_modules/@polymer/test-fixture/test-fixture.js"></script>
  <script src="../node_modules/sinon-chai/lib/sinon-chai.js"></script>
</head>

<body>

  <test-fixture id="default">
    <template>
      <cells-demo-dropdown-menu></cells-demo-dropdown-menu>
      <cells-demo-dropdown-menu></cells-demo-dropdown-menu>
    </template>
  </test-fixture>

  <script type="module">
  import './test.js';
  suite('<cells-demo-dropdown-menu>', () => {
      var el;
      var dropdown;

      setup(async () => {
        el = fixture('default')[0];
        await el.updateComplete;
        dropdown = el.shadowRoot.querySelector('.dropdown');
      });

      suite('Data binding and properties', () => {
        test('properties are properly binded', async () => {
          el.items = [{
            name: 'something',
            value: '1'
          }, {
            name: 'something 2',
            value: '2'
          }];
          el.selected = 1;
          el.iconCheck = 'icon-check';
          el.iconOpen = 'icon-open';

          await el.updateComplete;

          ['items', 'selected', 'iconOpen', 'iconCheck'].forEach((prop) => {
            assert.deepEqual(dropdown[prop], el[prop], `property ${prop} is binded to dropdown.${prop}`);
          });
        });

        test('setting label property sets the text over the dropdown', async () => {
          el.label = 'Any';
          await el.updateComplete;
          assert.equal(el.shadowRoot.querySelector('.label').innerText, el.label);
        });
      });

      test('has a unique ID for the label / aria-labelledby', async () => {
        var el2 = fixture('default')[1];
        await el.updateComplete;
        var label1 = el.shadowRoot.querySelector('.label').id;
        var label2 = el2.shadowRoot.querySelector('.label').id;
        assert.notEqual(label1, label2, 'each label gets an unique ID');
      });
    });
  </script>
</body>

</html>
